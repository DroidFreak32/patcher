From 8a705a338b6703e21f9fff191b2d9779c135727f Mon Sep 17 00:00:00 2001
From: maxwen <max.weninger@gmail.com>
Date: Sat, 8 Apr 2017 01:43:29 +0200
Subject: [PATCH] base: services: add config_fingerprintRemoveClientOnCancel

to call removeClient right in cancelAuthentification removing
possible delays when calling stop in startClient

Change-Id: Ia7fc2cb53e8182d0514f4773dfc914770b9ea585
---
 .../core/java/com/android/server/fingerprint/FingerprintService.java     | 1 +
 1 file changed, 1 insertion(+)

diff --git a/services/core/java/com/android/server/fingerprint/FingerprintService.java b/services/core/java/com/android/server/fingerprint/FingerprintService.java
index 6c11794..99330e4 100644
--- a/services/core/java/com/android/server/fingerprint/FingerprintService.java
+++ b/services/core/java/com/android/server/fingerprint/FingerprintService.java
@@ -822,6 +822,7 @@ public class FingerprintService extends SystemService implements IBinder.DeathRe
                             if (client.getToken() == token) {
                                 if (DEBUG) Slog.v(TAG, "stop client " + client.getOwnerString());
                                 client.stop(client.getToken() == token);
+                                removeClient(client);
                             } else {
                                 if (DEBUG) Slog.v(TAG, "can't stop client "
                                         + client.getOwnerString() + " since tokens don't match");
-- 
2.9.3

